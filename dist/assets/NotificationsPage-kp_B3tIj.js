import{t as _,q as N,r as A,ar as p,j as e,at as D,as as y}from"./index-B1PDI0VP.js";const v="_container_y722p_5",b="_title_y722p_15",m="_table_y722p_27",k="_actions_y722p_67",w="_accept_y722p_77",L="_decline_y722p_105",c={container:v,title:b,table:m,actions:k,accept:w,decline:L},M=s=>{const l=new Date,a=new Date(s),i=l-a,r=Math.floor(i/(1e3*60)),t=Math.floor(i/(1e3*60*60)),n=Math.floor(i/(1e3*60*60*24));return r<60?`${r} min ago`:t<24?`${t} hrs ago`:n===1?"Yesterday":n<=7?`${n} days ago`:a.toLocaleDateString()},j=({title:s,data:l,onApprove:a,onDecline:i})=>{console.log(l,"jjfk");const r=!(s.includes("User")||s.includes("Agent Notifications"));return e.jsxs("div",{className:c.section,children:[e.jsx("h2",{className:c.subtitle,children:s}),e.jsxs("table",{className:c.table,children:[r&&e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Name / Location"}),e.jsx("th",{children:"Time"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:l.map((t,n)=>e.jsxs("tr",{children:[e.jsx("td",{children:n+1}),e.jsx("td",{children:t.name||t.location||"-"}),e.jsx("td",{children:M(t.created_at)}),e.jsx("td",{children:new Date(t.created_at).toLocaleString()}),e.jsx("td",{children:(t.source==="agent_working_location"||t.source==="office_address"||t.source==="agent")&&e.jsxs("div",{className:c.actions,children:[e.jsx("button",{className:c.accept,onClick:()=>a(t.entity_id,t.source),children:"Accept"}),e.jsx("button",{className:c.decline,onClick:()=>i(t.entity_id,t.source),children:"Decline"})]})})]},n))})]})]})},S=()=>{const s=_(),{users:l,agents:a,agentWorkingLocations:i,officeAddresses:r,loading:t,error:n}=N(o=>o.notifications);A.useEffect(()=>{s(p())},[s]);const d=(o,h)=>{s(y({id:o,source:h})).then(()=>{s(p())})},f=(o,h)=>{s(D({id:o,source:h})).then(()=>{s(p())})},x=a||[],u=(r||[]).filter(o=>o.status!=="approved"),g=(i||[]).filter(o=>o.is_approved!==!0);return e.jsxs("div",{className:c.container,children:[e.jsx("h1",{className:c.title,children:"All Notifications"}),t?e.jsx("p",{children:"Loading..."}):n?e.jsxs("p",{children:["Error fetching notifications: ",n]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{title:"Office Address Notifications",data:u,onApprove:d,onDecline:f}),e.jsx(j,{title:"Agent Working Location Notifications",data:g,onApprove:d,onDecline:f}),e.jsx(j,{title:"Agent Request",data:x,onApprove:d,onDecline:f})]})]})};export{S as default};
