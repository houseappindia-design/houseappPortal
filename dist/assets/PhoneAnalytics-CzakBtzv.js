import{t as _,q as w,r as o,bz as I,j as t}from"./index-DpkaZWrN.js";import{D as Y,d as g}from"./index-Dzsf0CVM.js";import{S as x}from"./index-DBo6JS90.js";import{s as C}from"./index-Taqm7WFy.js";import{F as M}from"./Table-xf_ENmh-.js";import"./button-Dt2JUpkg.js";import"./BaseInput-B3LhqOGP.js";import"./useBreakpoint-CKKDg86l.js";import"./ExclamationCircleFilled-CpXgg2sl.js";import"./InfoCircleFilled-4f9TSxsu.js";import"./styleChecker-Bx8o0lrk.js";import"./addEventListener-DCYVsBvi.js";import"./LeftOutlined-BqRQVFk4.js";import"./EllipsisOutlined-DvdkXYl_.js";import"./Pagination-DQpAxfYX.js";import"./index-BtwUB7m6.js";import"./Input-mDCMwnQM.js";import"./getAllowClear-Bi388r9o.js";const{Option:n}=x,J=()=>{const y=_(),s=w(e=>e.interactions)||{total:0,page:1,limit:10,whatsapp:[],phone:[]},[i,f]=o.useState(s.page||1),[r,k]=o.useState(s.limit||10),[h,j]=o.useState("today"),[d,m]=o.useState(null),[c,u]=o.useState(null);o.useEffect(()=>{y(I({range:h,page:i,pageSize:r,startDate:d,endDate:c}))},[y,h,i,r,d,c]);const D=[...s.whatsapp.map((e,a)=>({key:`whatsapp-${a}`,...e})),...s.phone.map((e,a)=>({key:`phone-${a}`,...e}))],S=[{title:"Agent ID",dataIndex:"agent_id",key:"agent_id"},{title:"Agent Name",dataIndex:"agent_name",key:"agent_name"},{title:"Agent Phone",dataIndex:"agent_phone",key:"agent_phone"},{title:"User ID",dataIndex:"user_id",key:"user_id"},{title:"User Name",dataIndex:"user_name",key:"user_name"},{title:"User Phone",dataIndex:"user_phone",key:"user_phone"},{title:"Click Type",dataIndex:"click_type",key:"click_type",filters:[{text:"WhatsApp",value:"whatsapp"},{text:"Phone",value:"phone"}],onFilter:(e,a)=>a.click_type===e,render:e=>e.charAt(0).toUpperCase()+e.slice(1)},{title:"Clicked At",dataIndex:"clicked_at",key:"clicked_at",render:e=>new Date(e).toLocaleString(),sorter:(e,a)=>new Date(e.clicked_at)-new Date(a.clicked_at),defaultSortOrder:"descend"}],v=()=>{const e=s.total||0,a=(i-1)*r+1,p=Math.min(i*r,e);return t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsxs("div",{children:["Showing WhatsApp & Phone ",a," to ",p," of ",e," entries"]}),t.jsxs("div",{children:["Show  ",t.jsx(x,{value:r,onChange:l=>{k(l),f(1)},size:"small",style:{width:100},children:[5,10,20,50,100].map(l=>t.jsx(n,{value:l,children:l},l))}),"  entries"]})]})};return t.jsxs("div",{style:{padding:24},children:[t.jsx("h2",{children:"Phone & WhatsApp Interactions"}),t.jsxs("div",{style:{marginBottom:16,display:"flex",gap:16,flexWrap:"wrap"},children:[t.jsxs("div",{children:[t.jsx("span",{style:{marginRight:8},children:"Select Range:"}),t.jsxs(x,{value:h,onChange:e=>{j(e),m(null),u(null)},style:{width:160},children:[t.jsx(n,{value:"today",children:"Today"}),t.jsx(n,{value:"7d",children:"Last 7 Days"}),t.jsx(n,{value:"1m",children:"Last 1 Month"}),t.jsx(n,{value:"3m",children:"Last 3 Months"}),t.jsx(n,{value:"6m",children:"Last 6 Months"}),t.jsx(n,{value:"1y",children:"Last 1 Year"})]})]}),t.jsxs("div",{children:[t.jsx("span",{style:{marginRight:8},children:"Custom Dates:"}),t.jsx(Y.RangePicker,{format:"YYYY-MM-DD",allowClear:!0,value:d&&c?[g(d),g(c)]:[],onChange:e=>{if(e&&e.length===2){const[a,p]=e;if(g(p).isBefore(a)){C.error("End date cannot be before start date");return}m(a.format("YYYY-MM-DD")),u(p.format("YYYY-MM-DD")),j(null)}else m(null),u(null)}})]})]}),t.jsx(M,{columns:S,dataSource:D,pagination:{current:i,pageSize:r,total:s.total,onChange:e=>f(e),showSizeChanger:!1,position:["bottomRight"]},footer:v,bordered:!0,rowKey:"key"})]})};export{J as default};
