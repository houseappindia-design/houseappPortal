import{t as N,q,r as o,ao as D,j as a,a4 as K,ap as W}from"./index-ar-wW8Y1.js";import{u as b,w as G}from"./xlsx-QGj7q-Kj.js";import{D as H,d as s}from"./index-1k77Bzr6.js";import{S as Y}from"./Pagination-SU3SLqJQ.js";import{I as M}from"./index-BK3JDoMW.js";import{R as J}from"./SearchOutlined-iwZ2K_km.js";import{S as v}from"./index-BMpPtwSl.js";import{s as x}from"./index-2HXk8GLO.js";import{B as C}from"./button-BCWlUTrE.js";import{R as Q}from"./DownloadOutlined-C-kKSBkn.js";import{F as V}from"./Table-IuPX_Wg5.js";import{M as X}from"./index-5bofNX0R.js";import{T as Z}from"./BaseInput-Dex--e16.js";import{R as ee}from"./DeleteOutlined-Y4uqRGT-.js";import"./useBreakpoint-BQ0ZzjB-.js";import"./LeftOutlined-TRALdpwB.js";import"./Input-DYVU8m7g.js";import"./getAllowClear-BsFi4imL.js";import"./TextArea-3kCh4zOq.js";import"./ExclamationCircleFilled-WqnR6F3o.js";import"./InfoCircleFilled-DyHeZbDL.js";import"./DownloadOutlined-DTidZHln.js";import"./styleChecker-U0VtqI39.js";import"./addEventListener-be7uzAZi.js";import"./EllipsisOutlined-CsLI2rJ7.js";import"./index-Cm6oqKQF.js";import"./index-DH8r-IvP.js";import"./fade-CHbOdMiJ.js";import"./DeleteOutlined-DFutYCzo.js";const{RangePicker:te}=H,{Option:n}=v,Pe=()=>{const i=N(),{users:l,loading:E}=q(e=>e.user),I=(l==null?void 0:l.totalUsers)||0,w=(l==null?void 0:l.users)||[],P=w.filter(e=>e.name&&e.name.trim()!==""),[R,g]=o.useState(!1),[p,T]=o.useState(""),[c,A]=o.useState(10),[d,y]=o.useState(1),[m,f]=o.useState(null),[u,h]=o.useState(null),[U,_]=o.useState("SelectAll"),[O,k]=o.useState(null),[j,S]=o.useState("");o.useEffect(()=>{i(D({page:d,pageSize:c,search:p,startDate:m,endDate:u}))},[i,d,c,p,m,u]);const $=e=>{_(e);let t=null,r=s();switch(e){case"SelectAll":t=s().subtract(5,"year"),r=s();break;case"today":t=r;break;case"7d":t=s().subtract(7,"day");break;case"weekly":t=s().startOf("week");break;case"1m":t=s().subtract(1,"month");break;case"3m":t=s().subtract(3,"month");break;case"6m":t=s().subtract(6,"month");break;case"1y":t=s().subtract(1,"year");break;default:t=null,r=null;break}t&&r?(f(t.format("YYYY-MM-DD")),h(r.format("YYYY-MM-DD"))):(f(null),h(null))},B=e=>{k(e),S(""),g(!0)},z=()=>{if(!j){x.warning("Please enter your password");return}i(K(j)).then(e=>{var t,r;if(!((t=e.payload)!=null&&t.success)){x.error(((r=e.payload)==null?void 0:r.message)||"Incorrect password");return}i(W(O)),x.success("User deleted successfully"),g(!1),S(""),k(null),i(D({page:d,pageSize:c,search:p,startDate:m,endDate:u}))})},F=()=>{const e=b.json_to_sheet(w),t=b.book_new();b.book_append_sheet(t,e,"Userslist"),G(t,"users.xlsx")},L=[{title:"Sr.No",render:(e,t,r)=>(d-1)*c+r+1,width:70},{title:"Name",dataIndex:"name"},{title:"Email",dataIndex:"email"},{title:"Phone",dataIndex:"phone"},{title:"Location",dataIndex:"location"},{title:"Actions",render:(e,t)=>a.jsx(Y,{children:a.jsx(Z,{title:"Delete",children:a.jsx(C,{danger:!0,shape:"circle",icon:a.jsx(ee,{style:{color:"#fff"}}),style:{backgroundColor:"#ff4d4f",borderColor:"#ff4d4f"},onClick:()=>B(t.id)})})})}];return a.jsxs("div",{style:{padding:24},children:[a.jsxs(Y,{style:{marginBottom:16},wrap:!0,children:[a.jsx(M,{placeholder:"Search by name, email...",prefix:a.jsx(J,{}),value:p,onChange:e=>{T(e.target.value),y(1)},allowClear:!0}),a.jsx("span",{style:{marginRight:8},children:"Select Range:"}),a.jsxs(v,{value:U,onChange:e=>$(e),style:{width:160},children:[a.jsx(n,{value:"SelectAll",children:"Select All"}),a.jsx(n,{value:"today",children:"Today"}),a.jsx(n,{value:"7d",children:"7 Days"}),a.jsx(n,{value:"weekly",children:"Weekly"}),a.jsx(n,{value:"1m",children:"Monthly"}),a.jsx(n,{value:"3m",children:"3 Monthly"}),a.jsx(n,{value:"6m",children:"6 Monthly"}),a.jsx(n,{value:"1y",children:"Yearly"})]}),a.jsx(te,{format:"YYYY-MM-DD",value:m&&u?[s(m),s(u)]:[],onChange:e=>{if(e&&e.length===2){const[t,r]=e;if(s(r).isBefore(t)){x.error("End date cannot be before start date");return}f(t.format("YYYY-MM-DD")),h(r.format("YYYY-MM-DD")),y(1)}else f(null),h(null)}}),a.jsx(C,{icon:a.jsx(Q,{}),onClick:F,style:{background:"#1677ff",color:"#fff"},children:"Export Excel"})]}),a.jsx(V,{columns:L,dataSource:P,rowKey:"id",pagination:{current:d,pageSize:c,total:I,onChange:(e,t)=>{y(e),A(t)},showSizeChanger:!0,showTotal:(e,t)=>`Showing ${t[0]} to ${t[1]} of ${e} entries`},bordered:!0,style:{border:"1px solid #d9d9d9"}}),a.jsxs(X,{title:"Confirm Password",open:R,onOk:z,confirmLoading:E,onCancel:()=>g(!1),okText:"Delete",cancelText:"Cancel",children:[a.jsx("p",{children:"Please enter your password to confirm deletion:"}),a.jsx(M.Password,{value:j,onChange:e=>S(e.target.value),placeholder:"Enter password"})]})]})};export{Pe as default};
