import{t as N,q,r as o,ao as D,j as r,a4 as K,ap as W}from"./index-CfVxbtSE.js";import{u as b,w as G}from"./xlsx-QGj7q-Kj.js";import{D as H,d as s}from"./index-CDvgyEyM.js";import{S as Y}from"./Pagination-DQ3OUtW1.js";import{I as M}from"./index-De5IC8Mb.js";import{R as J}from"./SearchOutlined-B0KV3mx8.js";import{S as v}from"./index-Ca2fJ2Be.js";import{s as x}from"./index-CAWaTUU6.js";import{B as C}from"./button-C5_Hdfhk.js";import{R as Q}from"./DownloadOutlined-Dj7OlLq5.js";import{F as V}from"./Table-CrVbExSL.js";import{M as X}from"./index-D0fUZM7x.js";import{T as Z}from"./BaseInput-UAXxaOaj.js";import{R as ee}from"./DeleteOutlined-CEjlGUC9.js";import"./useBreakpoint-DahyjXEM.js";import"./LeftOutlined-Ox-gq8LW.js";import"./Input-CpVgZGc3.js";import"./getAllowClear-Uyr8yb_4.js";import"./EyeOutlined-CQIrlTwV.js";import"./TextArea-D1eH27Bs.js";import"./ExclamationCircleFilled-C_flDW-8.js";import"./InfoCircleFilled-B5DrW48x.js";import"./DownloadOutlined-DTidZHln.js";import"./styleChecker-jUO8vhoa.js";import"./addEventListener-CtglvHnr.js";import"./EllipsisOutlined-BDdOVdji.js";import"./index-0bLpuKAD.js";import"./index-rEwSGeGD.js";import"./fade-DAKRryvs.js";import"./DeleteOutlined-DFutYCzo.js";const{RangePicker:te}=H,{Option:n}=v,Re=()=>{const i=N(),{users:l,loading:E}=q(e=>e.user),I=(l==null?void 0:l.totalUsers)||0,w=(l==null?void 0:l.users)||[],P=w.filter(e=>e.name&&e.name.trim()!==""),[R,g]=o.useState(!1),[p,T]=o.useState(""),[c,A]=o.useState(10),[d,y]=o.useState(1),[m,f]=o.useState(null),[u,h]=o.useState(null),[U,_]=o.useState("SelectAll"),[O,k]=o.useState(null),[j,S]=o.useState("");o.useEffect(()=>{i(D({page:d,pageSize:c,search:p,startDate:m,endDate:u}))},[i,d,c,p,m,u]);const $=e=>{_(e);let t=null,a=s();switch(e){case"SelectAll":t=s().subtract(5,"year"),a=s();break;case"today":t=a;break;case"7d":t=s().subtract(7,"day");break;case"weekly":t=s().startOf("week");break;case"1m":t=s().subtract(1,"month");break;case"3m":t=s().subtract(3,"month");break;case"6m":t=s().subtract(6,"month");break;case"1y":t=s().subtract(1,"year");break;default:t=null,a=null;break}t&&a?(f(t.format("YYYY-MM-DD")),h(a.format("YYYY-MM-DD"))):(f(null),h(null))},B=e=>{k(e),S(""),g(!0)},z=()=>{if(!j){x.warning("Please enter your password");return}i(K(j)).then(e=>{var t,a;if(!((t=e.payload)!=null&&t.success)){x.error(((a=e.payload)==null?void 0:a.message)||"Incorrect password");return}i(W(O)),x.success("User deleted successfully"),g(!1),S(""),k(null),i(D({page:d,pageSize:c,search:p,startDate:m,endDate:u}))})},F=()=>{const e=b.json_to_sheet(w),t=b.book_new();b.book_append_sheet(t,e,"Userslist"),G(t,"users.xlsx")},L=[{title:"Sr.No",render:(e,t,a)=>(d-1)*c+a+1,width:70},{title:"Name",dataIndex:"name"},{title:"Email",dataIndex:"email"},{title:"Phone",dataIndex:"phone"},{title:"Location",dataIndex:"location"},{title:"Actions",render:(e,t)=>r.jsx(Y,{children:r.jsx(Z,{title:"Delete",children:r.jsx(C,{danger:!0,shape:"circle",icon:r.jsx(ee,{style:{color:"#fff"}}),style:{backgroundColor:"#ff4d4f",borderColor:"#ff4d4f"},onClick:()=>B(t.id)})})})}];return r.jsxs("div",{style:{padding:24},children:[r.jsxs(Y,{style:{marginBottom:16},wrap:!0,children:[r.jsx(M,{placeholder:"Search by name, email...",prefix:r.jsx(J,{}),value:p,onChange:e=>{T(e.target.value),y(1)},allowClear:!0}),r.jsx("span",{style:{marginRight:8},children:"Select Range:"}),r.jsxs(v,{value:U,onChange:e=>$(e),style:{width:160},children:[r.jsx(n,{value:"SelectAll",children:"Select All"}),r.jsx(n,{value:"today",children:"Today"}),r.jsx(n,{value:"7d",children:"7 Days"}),r.jsx(n,{value:"weekly",children:"Weekly"}),r.jsx(n,{value:"1m",children:"Monthly"}),r.jsx(n,{value:"3m",children:"3 Monthly"}),r.jsx(n,{value:"6m",children:"6 Monthly"}),r.jsx(n,{value:"1y",children:"Yearly"})]}),r.jsx(te,{format:"YYYY-MM-DD",value:m&&u?[s(m),s(u)]:[],onChange:e=>{if(e&&e.length===2){const[t,a]=e;if(s(a).isBefore(t)){x.error("End date cannot be before start date");return}f(t.format("YYYY-MM-DD")),h(a.format("YYYY-MM-DD")),y(1)}else f(null),h(null)}}),r.jsx(C,{icon:r.jsx(Q,{}),onClick:F,style:{background:"#1677ff",color:"#fff"},children:"Export Excel"})]}),r.jsx(V,{columns:L,dataSource:P,rowKey:"id",pagination:{current:d,pageSize:c,total:I,onChange:(e,t)=>{y(e),A(t)},showSizeChanger:!0,showTotal:(e,t)=>`Showing ${t[0]} to ${t[1]} of ${e} entries`},bordered:!0,style:{border:"1px solid #d9d9d9"}}),r.jsxs(X,{title:"Confirm Password",open:R,onOk:z,confirmLoading:E,onCancel:()=>g(!1),okText:"Delete",cancelText:"Cancel",children:[r.jsx("p",{children:"Please enter your password to confirm deletion:"}),r.jsx(M.Password,{value:j,onChange:e=>S(e.target.value),placeholder:"Enter password"})]})]})};export{Re as default};
